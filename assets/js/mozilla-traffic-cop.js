// Traffic cop source
if(void 0===Mozilla)var Mozilla={};Mozilla.TrafficCop=function(i){"use strict";this.config="object"==typeof i?i:{},this.id=this.config.id,this.variations=this.config.variations,this.totalPercentage=0,this.customCallback="function"==typeof this.config.customCallback?this.config.customCallback:null,this.cookieExpires=void 0!==this.config.cookieExpires?this.config.cookieExpires:Mozilla.TrafficCop.defaultCookieExpires,this.cookieExpiresDate=Mozilla.TrafficCop.generateCookieExpiresDate(this.cookieExpires),this.storeReferrerCookie=!1!==this.config.storeReferrerCookie,this.chosenVariation=null;for(var o in this.variations)this.variations.hasOwnProperty(o)&&"number"==typeof this.variations[o]&&(this.totalPercentage+=this.variations[o]);return this},Mozilla.TrafficCop.defaultCookieExpires=24,Mozilla.TrafficCop.noVariationCookieValue="novariation",Mozilla.TrafficCop.referrerCookieName="mozilla-traffic-cop-original-referrer",Mozilla.TrafficCop.prototype.init=function(){"function"==typeof Mozilla.dntEnabled&&Mozilla.dntEnabled()||void 0!==Mozilla.Cookies&&Mozilla.Cookies.enabled()&&this.verifyConfig()&&(this.chosenVariation=Mozilla.TrafficCop.chooseVariation(this.id,this.variations,this.totalPercentage),this.customCallback?this.initiateCustomCallbackRoutine():this.initiateRedirectRoutine())},Mozilla.TrafficCop.prototype.initiateCustomCallbackRoutine=function(){Mozilla.Cookies.setItem(this.id,this.chosenVariation||Mozilla.TrafficCop.noVariationCookieValue,this.cookieExpiresDate),this.customCallback(this.chosenVariation)},Mozilla.TrafficCop.prototype.initiateRedirectRoutine=function(){var i;Mozilla.TrafficCop.isRedirectVariation(this.variations)||((i=Mozilla.TrafficCop.generateRedirectUrl(this.chosenVariation))?(this.storeReferrerCookie?Mozilla.TrafficCop.setReferrerCookie(this.cookieExpiresDate):Mozilla.TrafficCop.clearReferrerCookie(),Mozilla.Cookies.setItem(this.id,this.chosenVariation,this.cookieExpiresDate),Mozilla.TrafficCop.performRedirect(i)):(Mozilla.Cookies.setItem(this.id,Mozilla.TrafficCop.noVariationCookieValue,this.cookieExpiresDate),Mozilla.TrafficCop.clearReferrerCookie()))},Mozilla.TrafficCop.prototype.verifyConfig=function(){return!(!this.id||"string"!=typeof this.id)&&(!(0===this.totalPercentage||this.totalPercentage>100)&&"number"==typeof this.cookieExpires)},Mozilla.TrafficCop.generateCookieExpiresDate=function(i,o){var e=null;return i>0&&(e=o||new Date).setHours(e.getHours()+i),e},Mozilla.TrafficCop.isRedirectVariation=function(i,o){var e=!1;o=o||window.location.search;for(var a in i)if(o.indexOf("?"+a)>-1||o.indexOf("&"+a)>-1){e=!0;break}return e},Mozilla.TrafficCop.chooseVariation=function(i,o,e){var a,t,r=Mozilla.TrafficCop.noVariationCookieValue;if(Mozilla.Cookies.hasItem(i)&&(o[Mozilla.Cookies.getItem(i)]||Mozilla.Cookies.getItem(i)===Mozilla.TrafficCop.noVariationCookieValue))r=Mozilla.Cookies.getItem(i);else if((a=Math.floor(100*Math.random())+1)<=e){t=0;for(var l in o){if(a<=o[l]+t){r=l;break}t+=o[l]}}return r},Mozilla.TrafficCop.generateRedirectUrl=function(i,o){var e,a,t;return(o=o||window.location.href).indexOf("#")>-1&&(o=(t=o.split("#"))[0],e=t[1]),i!==Mozilla.TrafficCop.noVariationCookieValue&&(a=o+(o.indexOf("?")>-1?"&":"?")+i,e&&(a+="#"+e)),a},Mozilla.TrafficCop.performRedirect=function(i){window.location.href=i},Mozilla.TrafficCop.setReferrerCookie=function(i,o){o=o||Mozilla.TrafficCop.getDocumentReferrer()||"direct",Mozilla.Cookies.setItem(Mozilla.TrafficCop.referrerCookieName,o,i)},Mozilla.TrafficCop.clearReferrerCookie=function(){Mozilla.Cookies.removeItem(Mozilla.TrafficCop.referrerCookieName)},Mozilla.TrafficCop.getDocumentReferrer=function(){return document.referrer};

// Cookie helper source
if(void 0===Mozilla)var Mozilla={};Mozilla.Cookies={getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,o,n,t,c,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var i="";if(n)switch(n.constructor){case Number:i=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:i="; expires="+n;break;case Date:i="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+i+(c?"; domain="+c:"")+(t?"; path="+t:"")+(r?"; secure":""),!0},removeItem:function(e,o,n){return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(o?"; path="+o:""),!0)},hasItem:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),o=e.length,n=0;n<o;n++)e[n]=decodeURIComponent(e[n]);return e},enabled:function(){try{document.cookie="cookietest=1";var e=-1!==document.cookie.indexOf("cookietest=");return document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT",e}catch(e){return!1}}};

// DNT source
if(void 0===Mozilla)var Mozilla={};Mozilla.dntEnabled=function(i,n){"use strict";var o=i||navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,t=n||navigator.userAgent,a=t.match(/Firefox\/(\d+)/),e=/MSIE|Trident/i.test(t),d=t.match(/Windows.+?(?=;)/g);return(!e||"function"==typeof Array.prototype.indexOf)&&"Enabled"===(o=a&&parseInt(a[1],10)<32?"Unspecified":e&&d&&-1!==["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3"].indexOf(d.toString())?"Unspecified":{0:"Disabled",1:"Enabled"}[o]||"Unspecified")};

